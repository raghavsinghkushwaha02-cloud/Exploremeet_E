<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ExploreMeet | Super Admin Panel</title>
    <style>
        body { background: #0a0a20; color: #fff; font-family: sans-serif; padding: 40px; }
        .card { background: #151530; padding: 25px; border-radius: 15px; border: 1px solid #333; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { text-align: left; padding: 15px; border-bottom: 1px solid #222; }
        .btn-ban { background: #ff4d4d; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; }
        .btn-vip { background: #ffd700; color: black; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        img { width: 40px; height: 40px; border-radius: 50%; }
    </style>
</head>
<body>

    <div id="admin-login" style="text-align:center; margin-top:100px;">
        <h1>Super Admin Access</h1>
        <button onclick="login()" style="padding:15px 40px; cursor:pointer;">Verify Google Identity</button>
    </div>

    <div id="admin-content" class="hidden" style="display:none;">
        <div class="card">
            <h2>User Management Console</h2>
            <table>
                <thead>
                    <tr><th>User</th><th>Email</th><th>VIP Status</th><th>Ban Status</th><th>Actions</th></tr>
                </thead>
                <tbody id="user-table"></tbody>
            </table>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, onValue, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDB6H5YFrr7gD7YmRsinknALrp5_RL3dLA",
            authDomain: "exploremeet---live.firebaseapp.com",
            databaseURL: "https://exploremeet---live-default-rtdb.firebaseio.com",
            projectId: "exploremeet---live",
            appId: "1:169038218786:web:4282137dbeb92000dbac7b"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);
        const SUPER_ADMIN = "raghavsinghkushwaha02@gmail.com";

        window.login = () => signInWithPopup(auth, new GoogleAuthProvider());

        onAuthStateChanged(auth, (user) => {
            if (user && user.email === SUPER_ADMIN) {
                document.getElementById('admin-login').style.display = 'none';
                document.getElementById('admin-content').style.display = 'block';
                loadUsers();
            } else if (user) {
                alert("Access Denied: unauthorized email.");
                signOut(auth).then(() => location.reload());
            }
        });

        function loadUsers() {
            onValue(ref(db, 'users'), (snapshot) => {
                const table = document.getElementById('user-table');
                table.innerHTML = "";
                snapshot.forEach(child => {
                    const u = child.val();
                    const uid = child.key;
                    table.innerHTML += `
                        <tr>
                            <td><img src="${u.photoURL}" referrerpolicy="no-referrer"> ${u.name}</td>
                            <td>${u.email}</td>
                            <td>${u.vip}</td>
                            <td>${u.isBanned ? '<span style="color:red">BANNED</span>' : 'ACTIVE'}</td>
                            <td>
                                <button class="btn-ban" onclick="toggleBan('${uid}', ${!u.isBanned})">${u.isBanned ? 'Unban' : 'Ban'}</button>
                                <button class="btn-vip" onclick="toggleVIP('${uid}', '${u.vip === 'VIP' ? 'Free' : 'VIP'}')">VIP</button>
                            </td>
                        </tr>
                    `;
                });
            });
        }

        window.toggleBan = (uid, status) => update(ref(db, `users/${uid}`), { isBanned: status });
        window.toggleVIP = (uid, plan) => update(ref(db, `users/${uid}`), { vip: plan });
    </script>
</body>
</html>
